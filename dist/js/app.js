function initialize(){var e={zoom:14,center:new google.maps.LatLng(48.77385,9.176832),disableDefaultUI:!0};map=new google.maps.Map(document.getElementById("map-canvas"),e)}var map;google.maps.event.addDomListener(window,"load",initialize),console.log("hello world");var config={foursquare:{URL:"https://api.foursquare.com/v2/venues/search",CLIENT_ID:"C0J5BP55MVKSIO5LDPV3DTZQFG0OH3TZCJPZL4C3KLMROETC",CLIENT_SECRET:"IM21TX0DTYM5DZ4ABJ2VABJUJR5U3NVKLGZVSJZMPWQQFM3J",API_VERSION:20130815}},Location=function(e){var o=this;o.name=ko.observable(e.name),o.lat=ko.observable(e.lat),o.lon=ko.observable(e.lon),o.address=ko.observable(e.address),o.checkins=ko.observable(e.checkins),o.hearts=ko.observable(e.hearts),o.loved=ko.computed(function(){return o.hearts()>5})},MapSearch=function(){var e=this;e.searchString=ko.observable(),e.loading=ko.observable(!1),e.search=function(){e.locations([]),e.searchString()&&(e.loading(!0),$.ajax({dataType:"json",url:config.foursquare.URL,data:{client_id:config.foursquare.CLIENT_ID,client_secret:config.foursquare.CLIENT_SECRET,v:config.foursquare.API_VERSION,ll:map.getCenter().toUrlValue(),query:e.searchString()}}).then(function(o){if(e.loading(!1),o&&o.response&&o.response.venues)for(var a=o.response.venues,n=a.length,t=0;n>t;t++){var s=a[t],o={name:s.name,lat:s.location.lat,lon:s.location.lng,address:s.location.formattedAddress[0],checkins:s.stats.checkinsCount,hearts:s.stats.tipCount};o.checkins&&o.hearts&&e.locations.push(new Location(o))}},function(e){alert("my bad...")}),console.log("searching for "+e.searchString()))},e.locations=ko.observableArray([]),e.locationsCount=ko.computed(function(){return e.locations().length}),e.listActive=ko.computed(function(){return e.locations().length>0})};ko.applyBindings(new MapSearch);